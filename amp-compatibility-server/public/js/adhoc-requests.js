window.addEventListener("DOMContentLoaded",(function(n){var e={pluginRowCounter:1,init:function(){var n=this;$(document).on("click",".dropdown-item",(function(){$(this).parents(".dropdown").find(".hiddenThemeVersion").val($(this).text()),$(this).parents(".dropdown").find(".hiddenPluginVersion").val($(this).text()),$(this).parents(".dropdown").find("button").text($(this).text())})),this.pluginsData=[],this.themeData=[],$.getJSON("/data/wporg_mapping/plugins.json",[],(function(e,t,i){for(var o in e)n.pluginsData.push(e[o].slug);n.preparePluginRow()})),$.getJSON("/data/wporg_mapping/themes.json",[],(function(e,t,i){for(var o in e)n.themeData.push(e[o].slug);n.themeAutocomplete()})),$("#addNewPlugin").on("click",(function(){n.removeDuplicatePlugins(),n.pluginRowCounter++;var e=$("#pluginClone").clone();e.removeAttr("id"),e.removeClass("d-none"),$("#plugin-name",e).attr("name","plugins[".concat(n.pluginRowCounter,"][name]")).removeAttr("id"),$("#plugin-version",e).attr("name","plugins[".concat(n.pluginRowCounter,"][version]")).removeAttr("id"),$("#plugin-list").append(e),n.preparePluginRow()})),this.bindEvents()},bindEvents:function(){jQuery('[name="amp_source"]').on("change",this.onAMPSourceChange)},onAMPSourceChange:function(){"other"===$(this).val()?$("#amp_source_url").removeAttr("disabled"):$("#amp_source_url").attr("disabled","true")},removeDuplicatePlugins:function(){var n={};$(".plugin-autocomplete").each((function(){var e=$(".plugin-autocomplete").length,t=$(this).val();e>2&&n[t]?$(this).parent().remove():n[t]=!0}))},preparePluginRow:function(){var n=this.pluginsData;jQuery(".plugin-autocomplete").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,10))}}),jQuery(".btn-remove-plugin").on("click",(function(){$("#plugin-list").find(".btn-remove-plugin").length>2&&$(this).parent(".plugin-item").remove()}))},themeAutocomplete:function(){var n=this.themeData;jQuery(".theme-autocomplete").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,20))}})},fetchThemeVersions:function(){$(".theme-autocomplete").on("focusout",(function(){var n=this;$.getJSON("/data/wporg_mapping/themes.json",[],(function(e,t,i){for(var o in $(n).siblings().find(".theme-dropdown").html(""),e){var u=$(n).val();""!==u&&e[o].name===u&&e[o].versions.map((function(e,t){$(n).siblings().find(".theme-dropdown").append('<li><a class="dropdown-item" href="#">'+e+"</a></li>")}))}}))}))},fetchPluginVersions:function(){$(document).on("focusout",".plugin-autocomplete",(function(){var n=this;$.getJSON("/data/wporg_mapping/plugins.json",[],(function(t,i,o){for(var u in e.removeDuplicatePlugins(),$(n).siblings().find(".plugin-dropdown").html(""),t){var a=$(n).val();""!==a&&t[u].name===a&&t[u].versions.map((function(e,t){$(n).siblings().find(".plugin-dropdown").append('<li><a class="dropdown-item" href="#">'+e+"</a></li>")}))}}))}))}};e.init(),e.fetchThemeVersions(),e.fetchPluginVersions()}));