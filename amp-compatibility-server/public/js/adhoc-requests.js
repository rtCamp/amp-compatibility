window.addEventListener("DOMContentLoaded",(function(n){({pluginRowCounter:1,init:function(){var n=this;this.preparePluginRow(),this.prepareThemeRow(),$('[name="amp_source"]').on("change",this.onAMPSourceChange),$(document).on("click",".dropdown-item",this.onDropdownItemClick),$("#addNewPlugin").on("click",(function(){n.onAddNewPluginClick()}))},onAMPSourceChange:function(){"other"===$(this).val()?$("#amp_source_url").removeAttr("disabled"):$("#amp_source_url").attr("disabled","true")},onDropdownItemClick:function(){var n=$(this).data("value");$(this).parents(".dropdown").find(".hiddenThemeVersion").val(n),$(this).parents(".dropdown").find(".hiddenPluginVersion").val(n),$(this).parents(".dropdown").find("button").text($(this).text())},onAddNewPluginClick:function(){this.pluginRowCounter++,this.removeDuplicatePlugins();var n=$("#pluginClone").clone();n.removeAttr("id"),n.removeClass("d-none"),$("#plugin-name",n).attr("name","plugins[".concat(this.pluginRowCounter,"][name]")).removeAttr("id"),$("#plugin-version",n).attr("name","plugins[".concat(this.pluginRowCounter,"][version]")).removeAttr("id"),$("#plugin-list").append(n),this.preparePluginRow()},removeDuplicatePlugins:function(){var n={};$(".plugin-autocomplete").each((function(){var e=$(".plugin-autocomplete").length,t=$(this).val();e>2&&n[t]?$(this).parent().remove():n[t]=!0}))},preparePluginRow:function(){$(".plugin-autocomplete").autocomplete({minLength:3,source:function(n,e){var t=n.term;$.getJSON("/admin/extensions/search/?type=plugin&s=".concat(t),(function(n){if("ok"===n.status){var t=[];for(var i in n.data)t.push({value:n.data[i].slug,label:n.data[i].name,versions:n.data[i].versions});e(t)}}))},select:function(n,e){var t=e.item.versions||[],i=$(n.target).siblings().find(".plugin-dropdown");$(i).html(""),$(i).append('<li><a class="dropdown-item" data-value="" href="#">Latest Version</a></li>'),t.map((function(n){$(i).append('<li><a class="dropdown-item" data-value="'.concat(n,'" href="#">').concat(n,"</a></li>"))}))}}),$(".btn-remove-plugin").on("click",(function(){$("#plugin-list").find(".btn-remove-plugin").length>2&&$(this).parent(".plugin-item").remove()}))},prepareThemeRow:function(){$(".theme-autocomplete").autocomplete({minLength:3,source:function(n,e){var t=n.term;$.getJSON("/admin/extensions/search/?type=theme&s=".concat(t),(function(n){if("ok"===n.status){var t=[];for(var i in n.data)t.push({value:n.data[i].slug,label:n.data[i].name,versions:n.data[i].versions});e(t)}}))},select:function(n,e){var t=e.item.versions||[],i=$(n.target).siblings().find(".theme-dropdown");$(i).html(""),$(i).append('<li><a class="dropdown-item" data-value="" href="#">Latest Version</a></li>'),t.map((function(n){$(i).append('<li><a class="dropdown-item" data-value="'.concat(n,'" href="#">').concat(n,"</a></li>"))}))}})}}).init()}));